var u=()=>()=>!0;function D(e,n){let{parseExpression:t=u}=n??{},l=m(e),o={requestDefinition:[],policyDefinition:[],roleDefinition:{},policyEffect:{},matchers:{}};for(let[r,i]of Object.entries(l))for(let p of i){let[s,c]=p.split(/=(.*)/).map((a)=>a.trim());if(!s||!c)continue;let f=r;switch(f){case"requestDefinition":case"policyDefinition":o[f]=d(c);break;case"roleDefinition":o.roleDefinition[s]=y(c);break;case"matchers":case"policyEffect":o[f][s]=t(c,s,f);break}}return o}function d(e){return e.split(/,\s*/)}function y(e){return e.split(/,\s*/).length}var M=/(?<type>[\w_]+)\](?<expr>[^[]+)/g;function m(e){let n=e.matchAll(M),t={};for(let l of n){let{type:o,expr:r}=l.groups??{};if(!o||!r)continue;t[x(o)]=r.split(`
`).map((i)=>i.trim()).filter((i)=>!!i)}return t}function x(e){return e.replace(/_([a-z])/g,(n,t)=>t.toUpperCase())}export{D as parseModel,u as naiveParser};
export{D as a};
