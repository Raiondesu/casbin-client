var Q=46;var T=32;var q=34,S=39,w=48,u=57,o=69,t=101,p=92;var x=5,s=10,N=20,e=30,b=40,h=50,k=60,l=70,g=80,J=90,Z=100,j=110,$=120;var M=140,K=150,z=170;var C,G,V=(m)=>(C=0,G=m,m=H(),G[C]?X():m||""),X=(m="Bad syntax",R=G.slice(0,C).split(`
`),P=R.pop())=>{let f=G.slice(C-108,C).split(`
`).pop(),I=G.slice(C,C+108).split(`
`).shift();throw EvalError(`${m} at ${R.length}:${P.length} \`${C>=108?"…":""}${f}┃${I}\``,"font-weight: bold")},n=(m,R=C,P)=>{while(P=m(G.charCodeAt(C)))C+=P;return G.slice(R,C)},B=(m=1,R=C)=>(C+=m,G.slice(R,C)),H=(m=0,R)=>{let P,f,I,F;while((P=Im())&&(I=((F=A[P])&&F(f,m))??(!f&&n(V.id))))f=I;if(R)P==R?C++:X();return f},Im=(m)=>{while((m=G.charCodeAt(C))<=T)C++;return m},Xm=V.id=(m)=>m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||m==36||m==95||m>=192&&m!=215&&m!=247,A=[],L=(m,R=T,P,f=m.charCodeAt(0),I=m.length,F=A[f],fm=m.toUpperCase()!==m)=>A[f]=(d,r,Y,ym=C)=>(Y?m==Y:(I<2||G.substr(C,I)==m)&&(Y=m))&&r<R&&!(fm&&V.id(G.charCodeAt(C+I)))&&(C+=I,P(d)||(C=ym,!F&&X()))||F?.(d,r,Y),E=(m,R,P=!1)=>L(m,R,(f,I)=>f&&(I=H(R-(P?0.5:0)))&&[m,f,I]),i=(m,R,P)=>L(m,R,(f)=>P?f&&[m,f]:!f&&(f=H(R-0.5))&&[m,f]),v=(m,R,P)=>{L(m,R,(f,I)=>(I=H(R),f?.[0]!==m&&(f=[m,f||null]),I?.[0]===m?f.push(...I.slice(1)):f.push(I||null),f))},U=(m,R)=>L(m[0],R,(P)=>!P&&[m,H(0,m.charCodeAt(1))]),W=(m,R)=>L(m[0],R,(P)=>P&&[m,P,H(0,m.charCodeAt(1))||null]),a=V;var c=(m,R)=>[,(m=+n((P)=>P===Q||P>=w&&P<=u||(P===o||P===t?2:0)))!=m?X():m];A[Q]=(m)=>!m&&c();for(let m=w;m<=u;m++)A[m]=(R)=>R?X():c();var Em={n:`
`,r:"\r",t:"\t",b:"\b",f:"\f",v:"\v"},mm=(m)=>(R,P,f="")=>{R&&X("Unexpected string"),B();while(P=G.charCodeAt(C),P-m)if(P===p)B(),P=B(),f+=Em[P]||P;else f+=B();return B()||X("Bad string"),[,f]};A[q]=mm(q);A[S]=mm(S);var _=(m)=>!Array.isArray(m)?_.id(m):!m[0]?()=>m[1]:O[m[0]].call(...m),Hm=_.id=(m)=>(R)=>R?.[m],O={},y=(m,R,P=O[m])=>O[m]=(...f)=>R(...f)||P?.(...f),D=(m,R,P,f,I)=>m[0]==="()"&&m.length==2?D(m[1],R,P):typeof m==="string"?(F)=>R(F,m,F):m[0]==="."?(f=_(m[1]),I=m[2],(F)=>R(f(F),I,F)):m[0]==="[]"&&m.length===3?(f=_(m[1]),I=_(m[2]),(F)=>R(f(F),I(F),F)):P?(m=_(m),(F)=>R([m(F)],0,F)):()=>X("Bad left value"),Rm=_;W("()",z);y("()",(m,R,P)=>R!==void 0&&(P=!R?()=>[]:R[0]===","?(R=R.slice(1).map((f)=>!f?err():_(f)),(f)=>R.map((I)=>I(f))):(R=_(R),(f)=>[R(f)]),D(m,(f,I,F)=>f[I](...P(F)),!0)));W("[]",z);y("[]",(m,R)=>!R?err():(m=_(m),R=_(R),(P)=>m(P)[R(P)]));E(".",z);y(".",(m,R)=>(m=_(m),R=!R[0]?R[1]:R,(P)=>m(P)[R]));U("()",z);y("()",(m,R)=>R===void 0&&(!m&&X("Empty ()"),_(m)));var Pm=(...m)=>(m=m.map(_),(R)=>m.map((P)=>P(R)).pop());v(",",s),y(",",Pm);v(";",x,!0),y(";",Pm);E("=",N,!0);y("=",(m,R)=>(R=_(R),D(m,(P,f,I)=>P[f]=R(I))));E("*",$),y("*",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)*R(P)));E("/",$),y("/",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)/R(P)));E("%",$),y("%",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)%R(P)));E("*=",N,!0);y("*=",(m,R)=>(R=_(R),D(m,(P,f,I)=>P[f]*=R(I))));E("/=",N,!0);y("/=",(m,R)=>(R=_(R),D(m,(P,f,I)=>P[f]/=R(I))));E("%=",N,!0);y("%=",(m,R)=>(R=_(R),D(m,(P,f,I)=>P[f]%=R(I))));E("+",j),y("+",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)+R(P)));E("-",j),y("-",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)-R(P)));i("+",M),y("+",(m,R)=>!R&&(m=_(m),(P)=>+m(P)));i("-",M),y("-",(m,R)=>!R&&(m=_(m),(P)=>-m(P)));E("+=",N,!0);y("+=",(m,R)=>(R=_(R),D(m,(P,f,I)=>P[f]+=R(I))));E("-=",N,!0);y("-=",(m,R)=>(R=_(R),D(m,(P,f,I)=>P[f]-=R(I))));L("++",K,(m)=>m?["++",m,null]:["++",H(K-1)]);y("++",(m,R)=>D(m,R===null?(P,f)=>P[f]++:(P,f)=>++P[f]));L("--",K,(m)=>m?["--",m,null]:["--",H(K-1)]);y("--",(m,R)=>D(m,R===null?(P,f)=>P[f]--:(P,f)=>--P[f]));i("~",M),y("~",(m,R)=>!R&&(m=_(m),(P)=>~m(P)));E("|",h),y("|",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)|R(P)));E("&",l),y("&",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)&R(P)));E("^",k),y("^",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)^R(P)));i("!",M),y("!",(m,R)=>!R&&(m=_(m),(P)=>!m(P)));E("||",e);y("||",(m,R)=>(m=_(m),R=_(R),(P)=>m(P)||R(P)));E("&&",b);y("&&",(m,R)=>(m=_(m),R=_(R),(P)=>m(P)&&R(P)));E("==",g),y("==",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)==R(P)));E("!=",g),y("!=",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)!=R(P)));E(">",J),y(">",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)>R(P)));E("<",J),y("<",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)<R(P)));E(">=",J),y(">=",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)>=R(P)));E("<=",J),y("<=",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)<=R(P)));E(">>",Z),y(">>",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)>>R(P)));E("<<",Z),y("<<",(m,R)=>R&&(m=_(m),R=_(R),(P)=>m(P)<<R(P)));E(">>=",N,!0);y(">>=",(m,R)=>(R=_(R),prop(m,(P,f,I)=>P[f]>>=R(I))));E("<<=",N,!0);y("<<=",(m,R)=>(R=_(R),prop(m,(P,f,I)=>P[f]<<=R(I))));var _m=(m)=>Rm(a(m));E("in",90);y("in",(m,R)=>R&&(m=_(m),R=_(R),(P)=>(m(P)in R(P))));L("undefined",20,(m)=>m?X():[,void 0]);L("NaN",20,(m)=>m?X():[,NaN]);L("null",20,(m)=>m?X():[,null]);function VR(m){return _m(m)}export{VR as parseExpression};
